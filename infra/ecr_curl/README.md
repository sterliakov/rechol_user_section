Adapted from https://stackoverflow.com/a/78501527/14401160
